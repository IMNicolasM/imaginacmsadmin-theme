"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[7368],{67368:(t,e,r)=>{r.r(e),r.d(e,{default:()=>g});var s=r(92444);function a(t,e,a,o,i,n){const l=(0,s.E1)("crud");return(0,s.Wz)(),(0,s.An)("div",null,[i.loading?(0,s.g1)("",!0):((0,s.Wz)(),(0,s.Az)(l,{key:0,"crud-data":r.e(5628).then(r.bind(r,65628)),"custom-data":n.crudData,ref:"crudRequests"},null,8,["crud-data","custom-data"]))])}var o=r(43408),i=r(7460),n=r.n(i),l=r(25699),c=r(84424),d=r(52329),u=r(8932);const h={data(){return{columns:[],filters:{},sort:{},loading:!0}},created(){this.$nextTick((async function(){await u.qu.set("app.data.filters",{}),this.getCrudReport()}))},computed:{reportId(){return this.$route.params?.id||null},crudInfo(){return this.$store.state.qcrudComponent.component[this.crudId]||{}},crudData(){return{read:{search:!1,columns:[...this.columns],filters:{...this.filters,reportId:{value:this.reportId}},requestParams:{order:{...this.sort}}}}}},methods:{async getCrudReport(){try{this.loading=!0,await this.$q.loading.show({spinner:l.c,spinnerColor:"blue",spinnerSize:140,backgroundColor:"white",message:this.$tr("ireports.cms.message.waitMoment"),messageColor:"black"});const t=await this.$crud.show("apiRoutes.qreports.reports",this.reportId,{refresh:!0,params:{include:"reportType"}});if(t.data.reportType){this.columns=await this.getColumns(t.data);const e=await this.getFilter(t.data);this.sort=await this.getSort(t.data),this.filters=await(0,o.c)().buildfilters(e,!0)}await this.$q.loading.hide(),this.loading=!1}catch(t){this.$q.loading.hide(),this.loading=!1}},async getColumns(t){try{const e=t.columns||[];return e.map((t=>({name:t,label:t,field:t,align:"left",format:t=>t||"-"}))).filter((e=>t.columns.some((t=>t===e.field))))}catch(e){console.log(e)}},async getFilter(t){try{const e=t.reportType.filters||{};return Object.keys(e).map((r=>{const s=Object.keys(t.filters||{}).some((t=>n().camelCase(t)===r));return e[r].value=s?t.filters[r]:null,{id:r,title:e[r].props.label,...e[r]}})).filter((e=>{const r=Object.keys(t.filters||{});return r.some((t=>t===e?.id))}))}catch(e){console.log(e)}},async getSort(t){try{const e=t.sort||{},r={};return Object.keys(e).forEach((t=>{r[t]=e[t]===d.CO?c.OS:c.iS})),r}catch(e){console.log(e)}}}};var p=r(68716);const m=(0,p.c)(h,[["render",a]]),g=m}}]);