"use strict";(globalThis["webpackChunkadmin_quasar"]=globalThis["webpackChunkadmin_quasar"]||[]).push([[8216],{35832:(t,e,o)=>{o.r(e),o.d(e,{default:()=>v});var i=o(92444),s=o(74044);const l={key:0,class:"box"},a={class:"text-grey-7 q-mr-xs"},r=["innerHTML"],n={key:0,class:"q-mt-sm"},c={class:"text-grey-7 q-mr-xs"},h={class:"q-my-sm",style:{"word-wrap":"break-word"}},d={class:"text-grey-7 q-mr-xs"},m={class:"ellipsis"},p={class:"text-grey-7 q-mr-xs"};function u(t,e,o,u,b,k){const f=(0,i.E1)("q-tooltip"),y=(0,i.E1)("master-modal");return(0,i.Wz)(),(0,i.Az)(y,{modelValue:b.showModal,"onUpdate:modelValue":e[0]||(e[0]=t=>b.showModal=t),onHide:e[1]||(e[1]=t=>k.resetModal()),title:b.hook?b.hook.title:"",loading:b.loading,actions:k.actionsModal},{default:(0,i.Ql)((()=>[b.hook?((0,i.Wz)(),(0,i.An)("div",l,[(0,i.QD)("section",null,[(0,i.QD)("label",a,(0,s.WA)(t.$tr("isite.cms.form.description"))+":",1),(0,i.QD)("div",{innerHTML:b.hook.description},null,8,r),b.hook.callEveryMinutes?((0,i.Wz)(),(0,i.An)("div",n,[(0,i.QD)("label",c,(0,s.WA)(t.$tr("iwebhooks.cms.form.callEveryMinutes"))+":",1),(0,i.mY)(" "+(0,s.WA)(b.hook.callEveryMinutes),1)])):(0,i.g1)("",!0)]),(0,i.QD)("section",null,[(0,i.QD)("div",h,[(0,i.QD)("label",d,(0,s.WA)(t.$tr("iwebhooks.cms.form.endpoint"))+":",1),(0,i.QD)("p",m,(0,s.WA)(b.hook.endpoint),1),(0,i.K2)(f,null,{default:(0,i.Ql)((()=>[(0,i.mY)((0,s.WA)(b.hook.endpoint),1)])),_:1})]),(0,i.QD)("div",null,[(0,i.QD)("label",p,(0,s.WA)(t.$tr("iwebhooks.cms.form.httpMethod"))+":",1),(0,i.mY)(" "+(0,s.WA)(b.hook.httpMethod),1)])])])):(0,i.g1)("",!0)])),_:1},8,["modelValue","title","loading","actions"])}var b=o(18528)["c"];const k={data(){return{crudId:this.$uid(),showModal:!1,hook:null,loading:!1,loadingBtn:!1}},computed:{crudData(){const t=!!this.$hasAccess("iwebhooks.hooks.dispatch");return{crudId:this.crudId,entityName:b("main.qwebhook.entityNames.hook"),apiRoute:"apiRoutes.qwebhook.hooks",permission:"iwebhooks.hooks",create:{title:this.$tr("iwebhooks.cms.title.newHook")},read:{columns:[{name:"id",label:this.$tr("isite.cms.form.id"),field:"id",align:"left"},{name:"title",label:this.$tr("isite.cms.form.title"),field:"title",align:"rigth"},{name:"endpoint",label:this.$tr("iwebhooks.cms.form.endpoint"),field:"endpoint",align:"left",...t?{action:t=>this.openModal(t)}:{}},{name:"maskEndpoint",label:this.$tr("iwebhooks.cms.form.maskEndpoint"),field:"maskEndpoint",align:"left"},{name:"category",label:this.$tr("isite.cms.form.category"),field:"category",align:"center",format:t=>t?.title||"-"},{name:"country",label:this.$tr("isite.cms.label.country"),field:"country",align:"center",format:t=>t?.name||"-"},{name:"callEveryMinutes",label:this.$tr("iwebhooks.cms.form.callEveryMinutes"),field:"callEveryMinutes",align:"center",format:t=>t?this.$trn(t):"-"},{name:"httpMethod",label:this.$tr("iwebhooks.cms.form.httpMethod"),field:"httpMethod",align:"rigth"},{name:"created_at",label:this.$tr("isite.cms.form.createdAt"),field:"createdAt",align:"left",format:t=>t?this.$trd(t):"-"},{name:"updated_at",label:this.$tr("isite.cms.form.updatedAt"),field:"updatedAt",align:"left",format:t=>t?this.$trd(t):"-"},{name:"actions",label:this.$tr("isite.cms.form.actions"),align:"left"}],requestParams:{include:"category,country"},actions:[{icon:"fa-regular fa-rocket",tooltip:this.$tr("iwebhooks.cms.label.dispatch"),vIf:t,color:"blue",action:t=>this.openModal(t)}]},update:{title:this.$tr("iwebhooks.cms.title.updateHook"),requestParams:{include:"category"}},delete:!0,formLeft:{id:{value:""},title:{value:"",type:"input",isTranslatable:!0,required:!0,props:{label:`${this.$tr("isite.cms.form.title")}*`}},description:{name:"description",value:"",type:"html",isTranslatable:!0,required:!0,props:{label:`${this.$tr("isite.cms.form.description")}*`}},actionLabel:{value:"",type:"input",isTranslatable:!0,props:{label:this.$tr("iwebhooks.cms.form.actionLabel")}},callEveryMinutes:{value:null,type:"input",props:{label:this.$tr("iwebhooks.cms.form.callEveryMinutes"),type:"number"}}},formRight:{endpoint:{value:"",type:"input",required:!0,props:{label:`${this.$tr("iwebhooks.cms.form.endpoint")}*`}},maskEndpoint:{value:"",type:"input",isTranslatable:!0,props:{label:this.$tr("iwebhooks.cms.form.maskEndpoint")}},categoryId:{type:"crud",props:{crudType:"select",crudData:o.e(5848).then(o.bind(o,55848)),crudProps:{label:`${this.$tr("isite.cms.form.category")}*`,rules:[t=>!!t||this.$tr("isite.cms.message.fieldRequired")]},config:{options:{label:"title",value:"id"}}}},httpMethod:{value:null,type:"select",required:!0,props:{label:`${this.$tr("iwebhooks.cms.form.httpMethod")}*`},loadOptions:{apiRoute:"apiRoutes.qsite.configs",select:{label:"label",id:"value"},requestParams:{filter:{configName:"Iwebhooks.config.httpMethodsOptions"}}}},countryId:{value:null,type:"select",props:{label:this.$tr("isite.cms.label.country"),clearable:!0},loadOptions:{apiRoute:"apiRoutes.qlocations.countries",select:{label:"name",id:"id"},filterByQuery:!0}},redirectLink:{value:"",type:"input",props:{label:this.$tr("iwebhooks.cms.form.redirectLink")}},body:{type:"json",props:{label:this.$tr("iwebhooks.cms.form.body")}},headers:{type:"json",props:{label:this.$tr("iwebhooks.cms.form.headers")}}}}},crudInfo(){return this.$store.state.qcrudComponent.component[this.crudId]||{}},actionsModal(){return[{props:{color:"primary",class:"full-width",vIf:!!this.hook?.actionLabel,label:this.hook?.actionLabel??"",loading:0!==this.hook?.isLoading||this.loadingBtn},action:()=>this.runWebhook(this.hook.id)}]}},methods:{resetModal(){this.showModal=!1,this.hook=null},openModal(t){this.showModal=!0,this.getHook(t.id)},async getHook(t){this.loading=!0;const e={refresh:!0};await this.$crud.show("apiRoutes.qwebhook.hooks",t,e).then((t=>{this.hook=t.data})).catch((t=>this.$alert.error(this.$tr("isite.cms.message.errorRequest")))),this.loading=!1},async runWebhook(t){this.loadingBtn=!0,await this.$crud.post(`${b("apiRoutes.qwebhook.hooks")}/dispatch/${t}`).catch((t=>this.$alert.error(this.$tr("isite.cms.message.errorRequest")))),this.loadingBtn=!1}}};var f=o(68716),y=o(90111),g=o(95252),$=o.n(g);const w=(0,f.c)(k,[["render",u]]),v=w;$()(k,"components",{QTooltip:y.c})}}]);